---
import BaseLayout from '../layouts/BaseLayout.astro';
import Clients from '../components/Clients.astro';
import GetEstimateBtn from '../components/GetEstimateBtn.astro';
import EstimateForm from '../components/EstimateForm.astro';
import RedLine from '../components/RedLine.astro';
const pageTitle = "Tarmac Company in Kent - Ashford Tarmac";
import BlogArchive from '../components/BlogArchive.astro';
---
<script>
import { gsap } from 'gsap';
import ScrollTrigger from 'gsap/ScrollTrigger';
import ScrollToPlugin from 'gsap/ScrollToPlugin';
gsap.registerPlugin(ScrollTrigger);
gsap.to(".btext", {
    x: 600,
    scrollTrigger: {
        trigger: '.container',
        start: "clamp(top bottom)",
        scrub: 2,
        pin: '.pin',
        pinSpacing: false,
        markers:false,
    },
});
gsap.to(".btext2", {
    x: -600,
    scrollTrigger: {
        trigger: '.container',
        start: "clamp(top bottom)",
        scrub: 2,
        pin: '.pin',
        pinSpacing: false,
        markers:false,
    },
});

const snapToSections = (selector:string) => {
    document.querySelectorAll(selector).forEach(e => {
        ScrollTrigger.create({
            trigger: e,
            pin: true
        })
    })
}
//snapToSections('[data-at-snap]')

// animation for the red background
const targetDiv = document.getElementById("target-div");
const observer = new IntersectionObserver((entries) => {
  entries.forEach((entry) => {
    if (entry.isIntersecting) {
      gsap.to(targetDiv, {
        duration: 1, // Adjust duration as needed
        css: { clipPath: "polygon(0 0, 100% 0, 100% 100%, 0 100%)" },
        ease: "power3.inOut" // Adjust easing if needed
      });
    }
  });
});
observer.observe(targetDiv);

/*
const gsapInitTabs = (root_selector) => {
    const root = document.querySelector(root_selector)
    if (!root) {
        return
    }

    const container:Array<Element> = [...document.querySelectorAll(`${root_selector} > div`)]
    const tabs:Array<Element> = [...document.querySelectorAll(`${root_selector} > div > h1`)]
    const content = Array.prototype.slice.call(document.querySelectorAll(`${root_selector} > div > div`), 0)
    const duration = 0.5
    
    const tl = gsap.timeline({repeat: -1, repeatDelay: 0, yoyo: true})
        .to(container[0], {width: 'calc(100%-7rem)'}, 0)
        .to(container[1], {width: '3.5rem'}, 0)
        .to(container[2], {width: '3.5rem'}, 0)
        .add('p0')
        .to(container[0], {width: '3.5rem'}, 1)
        .to(container[1], {width: 'calc(100%-7rem)'}, 1)
        .to(container[2], {width: '3.5rem'}, 1)
        .add('p1')
        .to(container[0], {width: '3.5rem'}, 2)
        .to(container[1], {width: '3.5rem'}, 2)
        .to(container[2], {width: 'calc(100%-7rem)'}, 2)
        .add('p2')
        .play()
    tabs.forEach((t, i) => t.addEventListener('click', e => {
        tl.tweenTo(`p${i}`, {duration: '1s'})
    }))
}
gsapInitTabs('#gs-tabs-1')
*/

const quadInitTabs = (selector:string) => {
    const delay_ms = 5000
    const speed_ms = 4000
    const root = document.querySelector(selector)

    if (root === null) {
        return
    }

    let active = 0
    let dir = 1
    let count = root.childElementCount
    let interval_token:number|undefined = undefined
    let timeout_token:number|undefined = window.setTimeout(() => {
        interval_token = window.setInterval(() => {
            if (active + dir === count || active + dir === -1) {
                dir = -dir
            }
            active += dir
            root.dataset.activeTab = `${active}`
        }, speed_ms)
    }, delay_ms)

    root.querySelectorAll(':scope > div > h1').forEach((element:Element, i:number) => element.addEventListener('click', () => {
        window.clearTimeout(timeout_token)
        window.clearInterval(interval_token)
        timeout_token = interval_token = undefined
        root.dataset.activeTab = i
    }))

    console.log(`delay: ${delay_ms}, interval: ${speed_ms}`)
}

quadInitTabs('#at-tabs-1')

const serviceSection = (selector:string, scroll_distance_factor:number) => {
    const root = document.querySelector(selector)
    const panel_root = root?.querySelector('[data-panels]')
    const progress = root?.querySelector('[data-progress]')
    if (!root || !panel_root || !progress) {
        return
    }
    const panels = [...panel_root.children]
    const panelWidth = panel_root.scrollWidth
    let pos = 0
    let prg = 0
    const hideShow = (e, i) => {
        e.style.display = i == pos ? 'inline-block' : 'none'
    }
    const tween = gsap.to(
        panels, {
            ease: "none",
            onUpdate: function() {
                prg = this.progress()
                pos = Math.min(Math.floor(prg * (panels.length + 1)), panels.length - 1)
                progress.dataset.progress = `${Math.round(prg * 100)}%`
                panels.forEach(hideShow)
            },
            scrollTrigger: {
                trigger: '[data-at-snap=services]',
                pin: true,
                start: 'top top',
                scrub: 1,
                end: () => `+=${panelWidth * scroll_distance_factor}`
            }
        });
}
serviceSection('[data-at-snap=services]', 2.5)

</script>
<style>
    #at-tabs-1 > div { transition: width 1s }
    #at-tabs-1 > div:last-child { width: calc(100% - 7rem) }
    #at-tabs-1 + div > div { transition: background-color 1s linear; }
    #at-tabs-1[data-active-tab="0"] > div:nth-child(1) { width: calc(100% - 7rem) }
    #at-tabs-1[data-active-tab="0"] > div:nth-child(2) { width: 3.5rem }
    #at-tabs-1[data-active-tab="0"] + div > div:nth-child(2) { background-color: red }
    #at-tabs-1[data-active-tab="1"] > div:nth-child(1) { width: 3.5rem }
    #at-tabs-1[data-active-tab="1"] > div:nth-child(2) { width: calc(100% - 7rem) }
    #at-tabs-1[data-active-tab="1"] + div > div:nth-child(3) { background-color: red }
    #at-tabs-1[data-active-tab="2"] > div:nth-child(1) { width: 3.5rem }
    #at-tabs-1[data-active-tab="2"] > div:nth-child(2) { width: 3.5rem }
    #at-tabs-1[data-active-tab="2"] + div > div:nth-child(4) { background-color: red }
</style>
<BaseLayout pageTitle={pageTitle}>
<!-- hero section --> 
<div class="flex">
    <div class="flex flex-none items-center justify-center border-r border-gray-dark border-solid w-12"></div>
    <div id="at-tabs-1" data-active-tab="0" class="flex flex-1 flex-shrink-0 p-1 h-[48rem] bg-[url('/driveway1.svg')] lg:bg-contain bg-fixed bg-no-repeat gap-0.5 relative overflow-hidden">
        <!--
        <div class="flex flex-item items-center justify-center w-14 bg-black border border-gray-dark border-solid rounded-xl hover:bg-red text-gray hover:text-black">
            
        </div>
        -->
        <div class="flex flex-none overflow-hidden relative">
            <h1 class="flex-none w-14 z-[2] cursor-pointer text-xl text-center font-light border border-gray-dark border-solid rounded-xl hover:bg-red hover:text-black bg-black text-gray"><span class="whitespace-nowrap uppercase vertical-lr align-middle relative h-[100%]">Commercial Tarmac Services</span></h1>
            <div class="flex-none pt-24 px-12 align-top relative z-[1] w-[calc(1200px-(3.5rem*5))]">
                <h2 class="text-red md:text-lg text-sm pb-2">Say Goodbye to Unreasonable Quotes & Unreliable Contractors</h2>
                <h3 class="text-white md:text-3xl text-xl font-bold normal-case">Transform your commercial space with quality tarmac</h3>
                <p class="text-sm text-white my-8 lg:pr-24">Welcome to Ashford Tarmac Contractors, where we pave the way for your commercial success. Is your commercial space in need of a new road or car park? Say goodbye to the frustration of searching for a reliable and reasonably priced contractor. </p>
                <GetEstimateBtn />
            </div>
        </div>
        <div class="flex flex-none overflow-hidden relative ml-0">
            <h1 class="flex-none w-14 z-[2] cursor-pointer text-xl text-center font-light border border-gray-dark border-solid rounded-xl hover:bg-red hover:text-black bg-gray-dark text-gray"><span class="whitespace-nowrap uppercase vertical-lr align-middle relative h-[100%]">Domestic Tarmac Services</span></h1>
            <div class="flex-none pt-24 px-12 align-top relative z-[1] w-[calc(1200px-(3.5rem*5))]">
                <h2 class="text-red md:text-lg text-sm pb-2">Say Goodbye to Unreasonable Quotes & Unreliable Contractors</h2>
                <h3 class="text-white md:text-3xl text-xl font-bold normal-case">Transform your commercial space with quality tarmac</h3>
                <p class="text-sm text-white my-8 lg:pr-24">Welcome to Ashford Tarmac Contractors, where we pave the way for your commercial success. Is your commercial space in need of a new road or car park? Say goodbye to the frustration of searching for a reliable and reasonably priced contractor. </p>
                <GetEstimateBtn />
            </div>
        </div>
        <div class="flex flex-none overflow-hidden relative">
            <h1 class="flex-none w-14 z-[2] cursor-pointer text-xl text-center font-light border border-gray-dark border-solid rounded-xl hover:bg-red hover:text-black bg-gray-light text-gray"><span class="whitespace-nowrap uppercase vertical-lr text-center align-middle relative h-[100%]">Public Sector Tarmac Services</span></h1>
            <div class="flex-none pt-24 px-12 align-top relative z-[1] w-[calc(1200px-(3.5rem*5))]">
                <h2 class="text-red md:text-lg text-sm pb-2">Say Goodbye to Unreasonable Quotes & Unreliable Contractors</h2>
                <h3 class="text-white md:text-3xl text-xl font-bold normal-case">Transform your commercial space with quality tarmac</h3>
                <p class="text-sm text-white my-8 lg:pr-24">Welcome to Ashford Tarmac Contractors, where we pave the way for your commercial success. Is your commercial space in need of a new road or car park? Say goodbye to the frustration of searching for a reliable and reasonably priced contractor. </p>
                <GetEstimateBtn />
            </div>
        </div>
    </div>
    <div class="flex flex-col flex-none items-center justify-start w-12 border-l border-gray-dark border-solid">
        <p class="text-gray font-light text-lg">100%</p>
        <div class="min-w-0.5 min-h-16 bg-black"></div>
        <div class="min-w-0.5 min-h-16 bg-gray"></div>
        <div class="min-w-0.5 min-h-16 bg-gray-dark"></div>
    </div>
</div>
<Clients />
<!-- Red section (about) -->
<div class="flex bg-red" id="target-div" data-at-snap>
    <div class="border-r border-red-dark border-solid w-12"></div>
    <div class="flex-1 flex-col items-center justify-center">
        <div class="flex flex-col items-start justify-center items-center py-6 bg-red">
            <p class="v-copy3 pr-2">about us</p>
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6 text-white">
                <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25 12 21m0 0-3.75-3.75M12 21V3" />
            </svg>
        </div>
        <div class="flex-col md:w-2/3">
            <h2 class="md:text-lg text-smh text-white pb-4 pt-12">Discover Our Kent Tarmac Legacy</h2>
            <h4 class="md:text-6xl text-3xl font-light">Ashford Tarmacadam Contractors is a Kent-based tarmac company with over 45 years of experience.</h4>
            <button class="bg-black hover:bg-white hover:text-black font-medium tracking-wide py-2 pl-4 pr-2 my-6 rounded-full flex items-center">
                <a class=" text-white" href="/about">About Ashford Tarmac</a>
                <span class="bg-red rounded-full p-2 ml-4">
                    <svg class="text-white font-400 fill-current" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
                    <path d="M12 4l-1.41 1.41L16.17 11H4v2h12.17l-5.58 5.59L12 20l8-8z"/>
                    </svg>
                </span>
            </button>
        </div>
        <div class="container w-full overflow-hidden">
            <div class="btext whitespace-nowrap md:text-7xl text-5xl text-gray font-bolder text-opacity-70 uppercase">ashford tarmac</div>
            <div class="btext2 whitespace-nowrap md:text-7xl text-5xl text-gray-dark font-bolder text-opacity-40 uppercase">driveways | roads</div>
        </div>
        <div class="bg-white md:w-3/5 flex"><p>&nbsp;</p></div>
    </div>
    <div class="border-l border-red-dark border-solid w-12"></div>
</div>
<!-- Service section -->
<div class="flex bg-white" data-at-snap="services">
    <div class="flex items-center justify-center border-r border-gray-light border-solid w-12">
        <p class="v-copy text-gray py-2">New Driveways | Resurfacing Tarmac | Tarmac Repairs | Resin Bound & Bond</p>
    </div>
    <!-- Main -->
    <div class="flex-1 flex-col items-center justify-center">
        <div class="flex flex-col items-start justify-center items-center pb-4">
            <p class="v-copy2 pr-2">services</p>
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6 text-red">
                <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25 12 21m0 0-3.75-3.75M12 21V3" />
            </svg>
        </div>
    <!-- Image and text -->
    <div class="md:flex pb-12">
        <div class="overflow-hidden w-[100%] md:w-3/5 whitespace-nowrap" data-panels="s1">
            <span class="inline-block width-[100%]"><img src="/driveway1.svg" alt="Domestic Driveway Tarmac Services in Kent"/></span>
            <span class="inline-block width-[100%]"><img src="/driveway2.svg" alt="Domestic Driveway Tarmac Services in Kent"/></span>
            <span class="inline-block width-[100%]"><img src="/driveway3.svg" alt="Domestic Driveway Tarmac Services in Kent"/></span>
            <span class="inline-block width-[100%]"><img src="/driveway4.svg" alt="Domestic Driveway Tarmac Services in Kent"/></span>
            <span class="inline-block width-[100%]"><img src="/driveway5.svg" alt="Domestic Driveway Tarmac Services in Kent"/></span>
            <span class="inline-block width-[100%]"><img src="/driveway6.svg" alt="Domestic Driveway Tarmac Services in Kent"/></span>
            <span class="inline-block width-[100%]"><img src="/driveway7.svg" alt="Domestic Driveway Tarmac Services in Kent"/></span>
            <span class="inline-block width-[100%]"><img src="/driveway8.svg" alt="Domestic Driveway Tarmac Services in Kent"/></span>
        </div>
        <div class="md:w-2/5 text-right">
                <h2 class="lg:text-lg text-gray pb-4">Service Sectors</h2>
                <h3 class="lg:text-3xl text-2xl font-bold text-gray-dark">Domestic Tarmac</h3>
                <h3 class="lg:text-3xl text-2xl font-bold text-black">Commercial Tarmac</h3>
                <h3 class="lg:text-3xl text-2xl font-bold text-gray">Public Sector Tarmac</h3>
            <span class="thin-text text-gray after:content-[attr(data-progress)]" data-progress="0%"></span>
            <div class="border-t border-red ml-8 block"></div>
            <p class="md:pl-6 text-black">Transform your home with our expertise in domestic tarmac services. From crafting beautiful driveways to repairing and resurfacing, we've been enhancing curb appeal for 45 years. Our team's dedication and long-standing commitment to quality ensure your dream project will come to life.</p>
            <button class="ml-auto bg-red hover:bg-black text-white font-medium tracking-wide py-2 pl-4 pr-2 my-6 rounded-full flex items-center">
                <span>More information</span>
                <span class="bg-black rounded-full p-2 ml-4">
                    <svg class="text-white font-400 fill-current" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
                    <path d="M12 4l-1.41 1.41L16.17 11H4v2h12.17l-5.58 5.59L12 20l8-8z"/>
                    </svg>
                </span>
            </button>
        </div>
    </div>
    <!-- Get estimate -->
    <EstimateForm />
    <div class="flex flex-col items-start justify-center items-center pb-4 pt-12">
        <p class="v-copy2 pr-16">tarmac articles</p>
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6 text-red">
            <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25 12 21m0 0-3.75-3.75M12 21V3" />
        </svg>
    </div>
    <!-- blog archive --> 
<BlogArchive />
</div><!--end of main -->
    <div class="border-l border-gray-light border-solid w-12 md:pt-24 pt-96">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-12 h-12 text-red">
            <path stroke-linecap="round" stroke-linejoin="round" d="m8.25 4.5 7.5 7.5-7.5 7.5" />
        </svg> 
    </div>
</div>
</BaseLayout>